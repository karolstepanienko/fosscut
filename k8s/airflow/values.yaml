# Recommended enforcing of standardised naming of resources
useStandardNaming: true

# Workloads will run only as separate pods in a k8s cluster
executor: "KubernetesExecutor"

# Allows running DAG task pods in every cluster namespace
multiNamespaceMode: true

# Triggerer is not necessary
triggerer:
  enabled: false

# Monitoring is not necessary
statsd:
  enabled: false

dags:
  gitSync:
    enabled: true
    repo: https://github.com/karolstepanienko/fosscut.git
    branch: main
    rev: HEAD
    subPath: "k8s/airflow/dags"

# Necessary for logs to be available through webserver
logs:
  persistence:
    enabled: True

# Mount HTTPS secrets
webserver:
  livenessProbe:
    scheme: HTTPS
  readinessProbe:
    scheme: HTTPS
  startupProbe:
    scheme: HTTPS
  extraVolumes:
    - name: airflow-webserver-tls-secret
      secret:
        secretName: airflow-webserver-tls-secret
        defaultMode: 0440
        optional: false
  extraVolumeMounts:
    - name: airflow-webserver-tls-secret
      mountPath: "/tls.crt"
      subPath: tls.crt
      readOnly: true
    - name: airflow-webserver-tls-secret
      mountPath: "/tls.key"
      subPath: tls.key
      readOnly: true

# Enable HTTPS in webserver settings
config:
  webserver:
    web_server_ssl_cert: /tls.crt
    web_server_ssl_key: /tls.key
